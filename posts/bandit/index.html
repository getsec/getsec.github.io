<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Call the police - we got a bandit. :: Blog — @me</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="The basics Today I would like to share with you some security lessons when using python. How we can use static linting to check our code for possible security flaws leveraging bandit. There will be some pretty obvious indicators of bad programming within this document, but only to demonstrate the power of the bandit. Not to highlight my inability to program. ☕️
First as always, we will create a virtual environment."/>
<meta name="keywords" content="python, security, lint"/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="/posts/bandit/" />




<link rel="stylesheet" href="/assets/style.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">

<link rel="shortcut icon" href="/img/favicon/orange.png">



<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Call the police - we got a bandit. :: Blog — @me" />
<meta name="twitter:description" content="The basics Today I would like to share with you some security lessons when using python. How we can use static linting to check our code for possible security flaws leveraging bandit. There will be some pretty obvious indicators of bad programming within this document, but only to demonstrate the power of the bandit. Not to highlight my inability to program. ☕️
First as always, we will create a virtual environment." />
<meta name="twitter:site" content="/" />
<meta name="twitter:creator" content="Nathan Getty" />
<meta name="twitter:image" content="">


<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Call the police - we got a bandit. :: Blog — @me">
<meta property="og:description" content="The basics Today I would like to share with you some security lessons when using python. How we can use static linting to check our code for possible security flaws leveraging bandit. There will be some pretty obvious indicators of bad programming within this document, but only to demonstrate the power of the bandit. Not to highlight my inability to program. ☕️
First as always, we will create a virtual environment." />
<meta property="og:url" content="/posts/bandit/" />
<meta property="og:site_name" content="Call the police - we got a bandit." />
<meta property="og:image" content="">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2020-01-29 10:04:03.128 &#43;0000 UTC" />











</head>
<body class="">


<div class="container headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Terminal
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/content/meta/about-me/">About</a></li>
        
      
      
    

    
    <div class="spacer"></div>
    <ul class="language-selector">
      <ul class="language-selector-current">
          <li>English ▾</li>
      </ul>
      <ul class="language-selector__more hidden">
        
      </ul>
    </ul>
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/content/meta/about-me/">About</a></li>
      
    
    
    <hr />
        
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="/posts/bandit/">Call the police - we got a bandit.</a></h1>
  <div class="post-meta">
      
    <span class="post-date">
      2020-01-29
    </span>
    
    
    <span class="post-author">::
      Nathan Getty
    </span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="/tags/python/">python</a>&nbsp;
    
    #<a href="/tags/security/">security</a>&nbsp;
    
    #<a href="/tags/lint/">lint</a>&nbsp;
    
  </span>
  

  

  <div class="post-content"><div>
        <h1 id="the-basics">The basics<a href="#the-basics" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>Today I would like to share with you some security lessons when using python. How we can use static linting to check our code for possible security flaws leveraging <em>bandit</em>. There will be some pretty obvious indicators of bad programming within this document, but only to demonstrate the power of the <em>bandit</em>. Not to highlight my inability to program. ☕️</p>
<p>First as always, we will create a virtual environment. We dont want to muck around with any of our old dependencies. <a href="https://xkcd.com/1987/">I love environments</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">python -m venv venv
source venv/bin/activate
pip install bandit
</code></pre></div><p>We can leverage the system function from the os library and pass in some pretty naughty input. No reason for that to be there.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#f92672">from</span> os <span style="color:#f92672">import</span> system

system(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">sudo su</span><span style="color:#e6db74">&#39;</span>)
</code></pre></div><p>Lets run bandit against our app to see if there are any issues it finds with aforementioned code snippet.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">bandit app_name.py
</code></pre></div><blockquote>
<p>Lets take a look at that juicy output</p>
</blockquote>
<pre><code>Test results:
&gt;&gt; Issue: [B605:start_process_with_a_shell] Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   Location: bad.py:3
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b605_start_process_with_a_shell.html
2
3       system('sudo su')

--------------------------------------------------
&gt;&gt; Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   Location: bad.py:3
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b607_start_process_with_partial_path.html
2
3       system('sudo su')

--------------------------------------------------

Code scanned:
        Total lines of code: 2
        Total lines skipped (#nosec): 0

Run metrics:
        Total issues (by severity):
                Undefined: 0.0
                Low: 2.0
                Medium: 0.0
                High: 0.0
        Total issues (by confidence):
                Undefined: 0.0
                Low: 0.0
                Medium: 0.0
                High: 2.0
Files skipped (0):
</code></pre><p>This is pretty nice it gives us all the results we need. We can use these results in a bunch of different ways, but in what I do is grep the report and look to see if there are any &ldquo;High or Medium&rdquo; severity items, and then kill the CI/CD pipeline.</p>
<h2 id="vscode-implementation">VSCode Implementation<a href="#vscode-implementation" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>In VSCode, what you can do is use CMD+Shift+P while in your python application and select linter, and choose bandit, you may be asked to install it, choose yes, ensure you tell VSCode to use bandit once more, and now, if you hover over the marked text, you will see the error/warnings.</p>
<h2 id="hey-nathan-what-if-i-want-to-do-this-in-a-cicd-thing">Hey Nathan! What if I want to do this in a CI/CD thing?<a href="#hey-nathan-what-if-i-want-to-do-this-in-a-cicd-thing" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>Oh damn jimmy, thats a pretty good idea. Now, I dont have an exact example but I this is how I would implement such a plan.</p>
<ol>
<li>With your CI/CD tool install the bandit library during your pre-build phase</li>
<li>Create a shell script to run bandit and parse the output for something you&rsquo;d want. this is only <em>psuedo code</em></li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#66d9ef">function</span> run_bandit<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">{</span>
        SEARCH_STR<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Severity: HIGH &#34;</span>
        <span style="color:#75715e"># Run bandit first of all, which is good</span>
        bandit $MY_FILE 
        bandit $MY_FILE | grep $SEARCH_STR
<span style="color:#f92672">}</span>

<span style="color:#75715e"># Run the bandit function and check to see if it passed</span>
<span style="color:#75715e"># in the if statement, if the grep fails, that means we should get an exit code non-zero. Which means nothing was found</span>
<span style="color:#75715e"># if we get a 0, that means the search string matched, which means we found something bad</span>
run_bandit

<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $? -ne <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>
<span style="color:#66d9ef">then</span>
        echo <span style="color:#e6db74">&#34;We&#39;re good&#34;</span>
        exit <span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">else</span>
        echo <span style="color:#e6db74">&#34;Uh oh, looks like we found some errors!&#34;</span>
        echo <span style="color:#e6db74">&#34;STOPPING BUILD&#34;</span>
        exit <span style="color:#ae81ff">1</span>
<span style="color:#66d9ef">fi</span>

</code></pre></div>
      </div></div>
  
  <div class="pagination">
    <div class="pagination__title">
      <span
        class="pagination__title-h"></span>
      <hr />
    </div>
    <div class="pagination__buttons">
      
      <span class="button previous">
        <a href="/posts/how-i-made-this-blog/">
          <span class="button__icon">←</span>
          <span class="button__text">How I Made This Blog</span>
        </a>
      </span>
      
      
      <span class="button next">
        <a href="/posts/cross-account-information-gathering/">
          <span class="button__text">Describe all the things in AWS</span>
          <span class="button__icon">→</span>
        </a>
      </span>
      
    </div>
  </div>
  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2020 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>





  
</div>

</body>
</html>
